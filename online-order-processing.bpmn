<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_OnlineOrder" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.41.0">
  <bpmn:error id="Error_PaymentFailed" name="PaymentError" errorCode="PAYMENT_FAILED" />
  <bpmn:error id="Error_InsufficientStock" name="StockError" errorCode="INSUFFICIENT_STOCK" />
  <bpmn:collaboration id="Collaboration_OnlineOrder">
    <bpmn:participant id="Participant_OrderProcessing" name="E-Commerce Platform" processRef="Process_OnlineOrder" />
  </bpmn:collaboration>
  <bpmn:process id="Process_OnlineOrder" name="Online Order Processing" isExecutable="true">
    <bpmn:laneSet id="LaneSet_1">
      <bpmn:lane id="Lane_Customer" name="Customer Service">
        <bpmn:flowNodeRef>Start_OrderReceived</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ValidateOrder</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_ValidOrder</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_NotifySuccess</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>End_OrderCompleted</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_NotifyRejection</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>End_OrderRejected</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_Operations" name="Operations">
        <bpmn:flowNodeRef>Task_CheckInventory</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_VerifyCredit</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ReserveItems</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_PackOrder</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ShipOrder</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_ParallelCheck</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_JoinChecks</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Gateway_AllChecksPassed</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_Finance" name="Finance">
        <bpmn:flowNodeRef>SubProcess_ProcessPayment</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_RefundCustomer</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>End_PaymentFailed</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Boundary_SubprocessError</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:startEvent id="Start_OrderReceived" name="Order Received">
      <bpmn:outgoing>Flow_Start_Validate</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="Task_ValidateOrder" name="Validate Order Data">
      <bpmn:incoming>Flow_Start_Validate</bpmn:incoming>
      <bpmn:outgoing>Flow_Validate_Gateway</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_ValidOrder" name="Valid Order?" default="Flow_Valid">
      <bpmn:incoming>Flow_Validate_Gateway</bpmn:incoming>
      <bpmn:outgoing>Flow_Valid</bpmn:outgoing>
      <bpmn:outgoing>Flow_Invalid</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Task_CheckInventory" name="Check Inventory" camunda:type="external" camunda:topic="checkStock">
      <bpmn:incoming>Flow_ToInventory</bpmn:incoming>
      <bpmn:outgoing>Flow_InventoryDone</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_VerifyCredit" name="Verify Credit Rating" camunda:type="external" camunda:topic="checkCredit">
      <bpmn:incoming>Flow_ToCredit</bpmn:incoming>
      <bpmn:outgoing>Flow_CreditDone</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:subProcess id="SubProcess_ProcessPayment" name="Process Payment">
      <bpmn:incoming>Flow_ChecksPassed</bpmn:incoming>
      <bpmn:outgoing>Flow_PaymentComplete</bpmn:outgoing>
      <bpmn:startEvent id="SubStart_Payment" name="Begin Payment">
        <bpmn:outgoing>SubFlow_Start_Calculate</bpmn:outgoing>
      </bpmn:startEvent>
      <bpmn:scriptTask id="SubTask_CalculateTotal" name="Calculate Total" scriptFormat="groovy">
        <bpmn:incoming>SubFlow_Start_Calculate</bpmn:incoming>
        <bpmn:outgoing>SubFlow_Calculate_Charge</bpmn:outgoing>
        <bpmn:script>
          def total = order.items.sum { it.price * it.quantity }
          execution.setVariable("totalAmount", total)
          execution.setVariable("retryCount", 0)
        </bpmn:script>
      </bpmn:scriptTask>
      <bpmn:serviceTask id="SubTask_ChargePayment" name="Charge Payment" camunda:type="external" camunda:topic="chargeCard">
        <bpmn:incoming>SubFlow_Calculate_Charge</bpmn:incoming>
        <bpmn:incoming>SubFlow_Retry</bpmn:incoming>
        <bpmn:outgoing>SubFlow_Charge_Confirm</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:serviceTask id="SubTask_ConfirmPayment" name="Confirm Payment" camunda:type="external" camunda:topic="confirmPayment">
        <bpmn:incoming>SubFlow_Charge_Confirm</bpmn:incoming>
        <bpmn:outgoing>SubFlow_Confirm_End</bpmn:outgoing>
      </bpmn:serviceTask>
      <bpmn:endEvent id="SubEnd_Success" name="Payment Confirmed">
        <bpmn:incoming>SubFlow_Confirm_End</bpmn:incoming>
      </bpmn:endEvent>
      <bpmn:boundaryEvent id="Boundary_PaymentError" name="Payment Failed" attachedToRef="SubTask_ChargePayment">
        <bpmn:outgoing>SubFlow_Error_Retry</bpmn:outgoing>
        <bpmn:errorEventDefinition errorRef="Error_PaymentFailed" />
      </bpmn:boundaryEvent>
      <bpmn:scriptTask id="SubTask_IncrementRetry" name="Increment Retry Counter" scriptFormat="groovy">
        <bpmn:incoming>SubFlow_Error_Retry</bpmn:incoming>
        <bpmn:outgoing>SubFlow_Increment_Gateway</bpmn:outgoing>
        <bpmn:script>
          def count = execution.getVariable("retryCount") ?: 0
          execution.setVariable("retryCount", count + 1)
        </bpmn:script>
      </bpmn:scriptTask>
      <bpmn:exclusiveGateway id="SubGateway_RetryCheck" name="Retries &#60; 3?" default="SubFlow_GiveUp">
        <bpmn:incoming>SubFlow_Increment_Gateway</bpmn:incoming>
        <bpmn:outgoing>SubFlow_Retry</bpmn:outgoing>
        <bpmn:outgoing>SubFlow_GiveUp</bpmn:outgoing>
      </bpmn:exclusiveGateway>
      <bpmn:endEvent id="SubEnd_Error" name="Payment Failed">
        <bpmn:incoming>SubFlow_GiveUp</bpmn:incoming>
        <bpmn:errorEventDefinition errorRef="Error_PaymentFailed" />
      </bpmn:endEvent>
      <bpmn:sequenceFlow id="SubFlow_Start_Calculate" sourceRef="SubStart_Payment" targetRef="SubTask_CalculateTotal" />
      <bpmn:sequenceFlow id="SubFlow_Calculate_Charge" sourceRef="SubTask_CalculateTotal" targetRef="SubTask_ChargePayment" />
      <bpmn:sequenceFlow id="SubFlow_Charge_Confirm" sourceRef="SubTask_ChargePayment" targetRef="SubTask_ConfirmPayment" />
      <bpmn:sequenceFlow id="SubFlow_Confirm_End" sourceRef="SubTask_ConfirmPayment" targetRef="SubEnd_Success" />
      <bpmn:sequenceFlow id="SubFlow_Error_Retry" sourceRef="Boundary_PaymentError" targetRef="SubTask_IncrementRetry" />
      <bpmn:sequenceFlow id="SubFlow_Increment_Gateway" sourceRef="SubTask_IncrementRetry" targetRef="SubGateway_RetryCheck" />
      <bpmn:sequenceFlow id="SubFlow_Retry" name="Yes" sourceRef="SubGateway_RetryCheck" targetRef="SubTask_ChargePayment">
        <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${retryCount &lt; 3}</bpmn:conditionExpression>
      </bpmn:sequenceFlow>
      <bpmn:sequenceFlow id="SubFlow_GiveUp" name="No" sourceRef="SubGateway_RetryCheck" targetRef="SubEnd_Error" />
    </bpmn:subProcess>
    <bpmn:serviceTask id="Task_RefundCustomer" name="Refund Customer" camunda:type="external" camunda:topic="refund">
      <bpmn:incoming>Flow_PaymentFailed</bpmn:incoming>
      <bpmn:outgoing>Flow_Refund_End</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="End_PaymentFailed" name="Payment Failed">
      <bpmn:incoming>Flow_Refund_End</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_Start_Validate" sourceRef="Start_OrderReceived" targetRef="Task_ValidateOrder" />
    <bpmn:sequenceFlow id="Flow_Validate_Gateway" sourceRef="Task_ValidateOrder" targetRef="Gateway_ValidOrder" />
    <bpmn:sequenceFlow id="Flow_Valid" name="Yes" sourceRef="Gateway_ValidOrder" targetRef="Gateway_ParallelCheck" />
    <bpmn:sequenceFlow id="Flow_Invalid" name="No" sourceRef="Gateway_ValidOrder" targetRef="Task_NotifyRejection">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!orderValid}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_NotifyRejection_End" sourceRef="Task_NotifyRejection" targetRef="End_OrderRejected" />
    <bpmn:sequenceFlow id="Flow_ToInventory" sourceRef="Gateway_ParallelCheck" targetRef="Task_CheckInventory" />
    <bpmn:sequenceFlow id="Flow_ToCredit" sourceRef="Gateway_ParallelCheck" targetRef="Task_VerifyCredit" />
    <bpmn:sequenceFlow id="Flow_InventoryDone" sourceRef="Task_CheckInventory" targetRef="Gateway_JoinChecks" />
    <bpmn:sequenceFlow id="Flow_CreditDone" sourceRef="Task_VerifyCredit" targetRef="Gateway_JoinChecks" />
    <bpmn:sequenceFlow id="Flow_ChecksComplete" sourceRef="Gateway_JoinChecks" targetRef="Gateway_AllChecksPassed" />
    <bpmn:sequenceFlow id="Flow_ChecksPassed" name="Yes" sourceRef="Gateway_AllChecksPassed" targetRef="SubProcess_ProcessPayment" />
    <bpmn:sequenceFlow id="Flow_ChecksFailed" name="No" sourceRef="Gateway_AllChecksPassed" targetRef="Task_NotifyRejection">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!checksPass}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_PaymentComplete" sourceRef="SubProcess_ProcessPayment" targetRef="Task_ReserveItems" />
    <bpmn:sequenceFlow id="Flow_PaymentFailed" sourceRef="Boundary_SubprocessError" targetRef="Task_RefundCustomer" />
    <bpmn:sequenceFlow id="Flow_Refund_End" sourceRef="Task_RefundCustomer" targetRef="End_PaymentFailed" />
    <bpmn:sequenceFlow id="Flow_Reserve_Pack" sourceRef="Task_ReserveItems" targetRef="Task_PackOrder" />
    <bpmn:sequenceFlow id="Flow_Pack_Ship" sourceRef="Task_PackOrder" targetRef="Task_ShipOrder" />
    <bpmn:sequenceFlow id="Flow_Ship_Notify" sourceRef="Task_ShipOrder" targetRef="Task_NotifySuccess" />
    <bpmn:sequenceFlow id="Flow_NotifySuccess_End" sourceRef="Task_NotifySuccess" targetRef="End_OrderCompleted" />
    <bpmn:serviceTask id="Task_ReserveItems" name="Reserve Items" camunda:type="external" camunda:topic="reserveStock">
      <bpmn:incoming>Flow_PaymentComplete</bpmn:incoming>
      <bpmn:outgoing>Flow_Reserve_Pack</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:userTask id="Task_PackOrder" name="Pack Order">
      <bpmn:incoming>Flow_Reserve_Pack</bpmn:incoming>
      <bpmn:outgoing>Flow_Pack_Ship</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="Task_ShipOrder" name="Ship Order" camunda:type="external" camunda:topic="shipment">
      <bpmn:incoming>Flow_Pack_Ship</bpmn:incoming>
      <bpmn:outgoing>Flow_Ship_Notify</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:boundaryEvent id="Boundary_SubprocessError" name="Payment Subprocess Failed" attachedToRef="SubProcess_ProcessPayment">
      <bpmn:outgoing>Flow_PaymentFailed</bpmn:outgoing>
      <bpmn:errorEventDefinition errorRef="Error_PaymentFailed" />
    </bpmn:boundaryEvent>
    <bpmn:parallelGateway id="Gateway_ParallelCheck" name="Start Checks">
      <bpmn:incoming>Flow_Valid</bpmn:incoming>
      <bpmn:outgoing>Flow_ToInventory</bpmn:outgoing>
      <bpmn:outgoing>Flow_ToCredit</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:parallelGateway id="Gateway_JoinChecks" name="Sync Checks">
      <bpmn:incoming>Flow_InventoryDone</bpmn:incoming>
      <bpmn:incoming>Flow_CreditDone</bpmn:incoming>
      <bpmn:outgoing>Flow_ChecksComplete</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:exclusiveGateway id="Gateway_AllChecksPassed" name="All Checks Passed?" default="Flow_ChecksPassed">
      <bpmn:incoming>Flow_ChecksComplete</bpmn:incoming>
      <bpmn:outgoing>Flow_ChecksPassed</bpmn:outgoing>
      <bpmn:outgoing>Flow_ChecksFailed</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Task_NotifySuccess" name="Notify Success" camunda:type="external" camunda:topic="notifyCustomer">
      <bpmn:incoming>Flow_Ship_Notify</bpmn:incoming>
      <bpmn:outgoing>Flow_NotifySuccess_End</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="End_OrderCompleted" name="Order Completed">
      <bpmn:incoming>Flow_NotifySuccess_End</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Task_NotifyRejection" name="Notify Rejection" camunda:type="external" camunda:topic="notifyCustomer">
      <bpmn:incoming>Flow_Invalid</bpmn:incoming>
      <bpmn:incoming>Flow_ChecksFailed</bpmn:incoming>
      <bpmn:outgoing>Flow_NotifyRejection_End</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="End_OrderRejected" name="Order Rejected">
      <bpmn:incoming>Flow_NotifyRejection_End</bpmn:incoming>
    </bpmn:endEvent>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_OnlineOrder">
      <bpmndi:BPMNShape id="Participant_OrderProcessing_di" bpmnElement="Participant_OrderProcessing" isHorizontal="true">
        <dc:Bounds x="130" y="50" width="1900" height="650" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_Finance_di" bpmnElement="Lane_Finance" isHorizontal="true">
        <dc:Bounds x="160" y="500" width="1870" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_Operations_di" bpmnElement="Lane_Operations" isHorizontal="true">
        <dc:Bounds x="160" y="250" width="1870" height="250" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Lane_Customer_di" bpmnElement="Lane_Customer" isHorizontal="true">
        <dc:Bounds x="160" y="50" width="1870" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Start_OrderReceived_di" bpmnElement="Start_OrderReceived">
        <dc:Bounds x="212" y="122" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="191" y="165" width="78" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_ValidateOrder_di" bpmnElement="Task_ValidateOrder">
        <dc:Bounds x="300" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_ValidOrder_di" bpmnElement="Gateway_ValidOrder" isMarkerVisible="true">
        <dc:Bounds x="455" y="115" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="445" y="85" width="62" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_CheckInventory_di" bpmnElement="Task_CheckInventory">
        <dc:Bounds x="560" y="280" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_VerifyCredit_di" bpmnElement="Task_VerifyCredit">
        <dc:Bounds x="560" y="400" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_ReserveItems_di" bpmnElement="Task_ReserveItems">
        <dc:Bounds x="890" y="400" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_PackOrder_di" bpmnElement="Task_PackOrder">
        <dc:Bounds x="1070" y="400" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_ShipOrder_di" bpmnElement="Task_ShipOrder">
        <dc:Bounds x="1210" y="400" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_ParallelCheck_di" bpmnElement="Gateway_ParallelCheck">
        <dc:Bounds x="455" y="295" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="381.5" y="313" width="63" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_JoinChecks_di" bpmnElement="Gateway_JoinChecks">
        <dc:Bounds x="715" y="295" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="705" y="275" width="65" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_AllChecksPassed_di" bpmnElement="Gateway_AllChecksPassed" isMarkerVisible="true">
        <dc:Bounds x="815" y="295" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="814" y="256" width="52" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_NotifySuccess_di" bpmnElement="Task_NotifySuccess">
        <dc:Bounds x="1670" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_OrderCompleted_di" bpmnElement="End_OrderCompleted">
        <dc:Bounds x="1872" y="182" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1848" y="225" width="85" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_NotifyRejection_di" bpmnElement="Task_NotifyRejection">
        <dc:Bounds x="1480" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_OrderRejected_di" bpmnElement="End_OrderRejected">
        <dc:Bounds x="1872" y="122" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1853" y="165" width="75" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubProcess_ProcessPayment_di" bpmnElement="SubProcess_ProcessPayment" isExpanded="false">
        <dc:Bounds x="1100" y="565" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_RefundCustomer_di" bpmnElement="Task_RefundCustomer">
        <dc:Bounds x="1480" y="565" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_PaymentFailed_di" bpmnElement="End_PaymentFailed">
        <dc:Bounds x="1642" y="587" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1620" y="630" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Boundary_SubprocessError_di" bpmnElement="Boundary_SubprocessError">
        <dc:Bounds x="1162" y="627" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1210" y="640" width="59" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_Start_Validate_di" bpmnElement="Flow_Start_Validate">
        <di:waypoint x="248" y="140" />
        <di:waypoint x="300" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Validate_Gateway_di" bpmnElement="Flow_Validate_Gateway">
        <di:waypoint x="400" y="140" />
        <di:waypoint x="455" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Valid_di" bpmnElement="Flow_Valid">
        <di:waypoint x="480" y="165" />
        <di:waypoint x="480" y="295" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="486" y="219" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Invalid_di" bpmnElement="Flow_Invalid">
        <di:waypoint x="505" y="140" />
        <di:waypoint x="1480" y="140" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="986" y="122" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_NotifyRejection_End_di" bpmnElement="Flow_NotifyRejection_End">
        <di:waypoint x="1580" y="140" />
        <di:waypoint x="1872" y="140" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ToInventory_di" bpmnElement="Flow_ToInventory">
        <di:waypoint x="505" y="320" />
        <di:waypoint x="560" y="320" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ToCredit_di" bpmnElement="Flow_ToCredit">
        <di:waypoint x="480" y="345" />
        <di:waypoint x="480" y="440" />
        <di:waypoint x="560" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_InventoryDone_di" bpmnElement="Flow_InventoryDone">
        <di:waypoint x="660" y="320" />
        <di:waypoint x="715" y="320" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_CreditDone_di" bpmnElement="Flow_CreditDone">
        <di:waypoint x="660" y="440" />
        <di:waypoint x="740" y="440" />
        <di:waypoint x="740" y="345" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ChecksComplete_di" bpmnElement="Flow_ChecksComplete">
        <di:waypoint x="765" y="320" />
        <di:waypoint x="815" y="320" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ChecksPassed_di" bpmnElement="Flow_ChecksPassed">
        <di:waypoint x="840" y="345" />
        <di:waypoint x="840" y="605" />
        <di:waypoint x="1100" y="605" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="846" y="467" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_ChecksFailed_di" bpmnElement="Flow_ChecksFailed">
        <di:waypoint x="865" y="320" />
        <di:waypoint x="1530" y="320" />
        <di:waypoint x="1530" y="180" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1190" y="302" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_PaymentComplete_di" bpmnElement="Flow_PaymentComplete">
        <di:waypoint x="1150" y="565" />
        <di:waypoint x="1150" y="540" />
        <di:waypoint x="940" y="540" />
        <di:waypoint x="940" y="480" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_PaymentFailed_di" bpmnElement="Flow_PaymentFailed">
        <di:waypoint x="1180" y="663" />
        <di:waypoint x="1180" y="690" />
        <di:waypoint x="1530" y="690" />
        <di:waypoint x="1530" y="645" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Refund_End_di" bpmnElement="Flow_Refund_End">
        <di:waypoint x="1580" y="605" />
        <di:waypoint x="1642" y="605" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Reserve_Pack_di" bpmnElement="Flow_Reserve_Pack">
        <di:waypoint x="990" y="440" />
        <di:waypoint x="1070" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Pack_Ship_di" bpmnElement="Flow_Pack_Ship">
        <di:waypoint x="1170" y="440" />
        <di:waypoint x="1210" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Ship_Notify_di" bpmnElement="Flow_Ship_Notify">
        <di:waypoint x="1310" y="440" />
        <di:waypoint x="1720" y="440" />
        <di:waypoint x="1720" y="240" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_NotifySuccess_End_di" bpmnElement="Flow_NotifySuccess_End">
        <di:waypoint x="1770" y="200" />
        <di:waypoint x="1872" y="200" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
  <bpmndi:BPMNDiagram id="BPMNDiagram_0mjrh2a">
    <bpmndi:BPMNPlane id="BPMNPlane_0ix3986" bpmnElement="SubProcess_ProcessPayment">
      <bpmndi:BPMNShape id="SubTask_CalculateTotal_di" bpmnElement="SubTask_CalculateTotal">
        <dc:Bounds x="300" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubTask_ConfirmPayment_di" bpmnElement="SubTask_ConfirmPayment">
        <dc:Bounds x="720" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubEnd_Success_di" bpmnElement="SubEnd_Success">
        <dc:Bounds x="942" y="182" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="935" y="225" width="51" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubTask_ChargePayment_di" bpmnElement="SubTask_ChargePayment">
        <dc:Bounds x="468" y="160" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubStart_Payment_di" bpmnElement="SubStart_Payment">
        <dc:Bounds x="182" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="172" y="73" width="75" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubTask_IncrementRetry_di" bpmnElement="SubTask_IncrementRetry">
        <dc:Bounds x="640" y="380" width="100" height="60" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubGateway_RetryCheck_di" bpmnElement="SubGateway_RetryCheck" isMarkerVisible="true">
        <dc:Bounds x="493" y="385" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="423" y="403" width="60" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SubEnd_Error_di" bpmnElement="SubEnd_Error">
        <dc:Bounds x="662" y="562" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="642" y="605" width="77" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Boundary_PaymentError_di" bpmnElement="Boundary_PaymentError">
        <dc:Bounds x="550" y="222" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="586" y="250" width="77" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SubFlow_Start_Calculate_di" bpmnElement="SubFlow_Start_Calculate">
        <di:waypoint x="218" y="120" />
        <di:waypoint x="300" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_Calculate_Charge_di" bpmnElement="SubFlow_Calculate_Charge">
        <di:waypoint x="400" y="120" />
        <di:waypoint x="518" y="120" />
        <di:waypoint x="518" y="160" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_Retry_di" bpmnElement="SubFlow_Retry">
        <di:waypoint x="518" y="385" />
        <di:waypoint x="518" y="240" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="531" y="323" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_Charge_Confirm_di" bpmnElement="SubFlow_Charge_Confirm">
        <di:waypoint x="568" y="200" />
        <di:waypoint x="720" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_Confirm_End_di" bpmnElement="SubFlow_Confirm_End">
        <di:waypoint x="820" y="200" />
        <di:waypoint x="942" y="200" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_Error_Retry_di" bpmnElement="SubFlow_Error_Retry">
        <di:waypoint x="586" y="240" />
        <di:waypoint x="690" y="240" />
        <di:waypoint x="690" y="380" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_Increment_Gateway_di" bpmnElement="SubFlow_Increment_Gateway">
        <di:waypoint x="640" y="410" />
        <di:waypoint x="543" y="410" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SubFlow_GiveUp_di" bpmnElement="SubFlow_GiveUp">
        <di:waypoint x="518" y="435" />
        <di:waypoint x="518" y="580" />
        <di:waypoint x="662" y="580" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="568" y="562" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
